<!doctype html>
<html lang="zh-CN">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<title>简易新闻汇聚</title>
<style>
  :root{
    --fg:#111; --muted:#5f6368; --link:#0b57d0; --border:#e9e9ee; --chip-bg:#eef;
    --radius:14px; --gap:14px;
    --h1: clamp(22px, 4.6vw, 32px);
    --title: clamp(16px, 3.8vw, 20px);
    --meta: clamp(12px, 3.2vw, 14px);
    --container: min(720px, 92vw);
  }
  @media (prefers-color-scheme: dark){
    :root{ --fg:#e8eaed; --muted:#a3a6aa; --link:#9ec3ff; --border:#2c2f36; --chip-bg:#2a2f45; }
    body{ background:#0e1116; }
  }
  html,body{ height:100%; }
  body{
    -webkit-text-size-adjust:100%;
    margin:0; color:var(--fg); font: 16px/1.6 system-ui, -apple-system, "Segoe UI", Roboto, "PingFang SC",
      "Helvetica Neue", Arial, "Noto Sans CJK SC", "Microsoft YaHei", sans-serif;
  }
  .wrap{ width:var(--container); margin: max(10px, env(safe-area-inset-top)) auto 24px;
         padding: 0 max(12px, env(safe-area-inset-left)) 24px max(12px, env(safe-area-inset-right)); }
  header{ display:flex; align-items:baseline; justify-content:space-between; gap:10px; margin:18px 0 8px; }
  h1{ font-size:var(--h1); margin:0; letter-spacing:.02em; font-weight:700; }
  .chip{ font-size:var(--meta); background:var(--chip-bg); padding:6px 10px; border-radius:999px; white-space:nowrap; }
  ul{ list-style:none; margin:0; padding:0; }
  li{ border-bottom:1px solid var(--border); }
  .item{ display:block; padding:14px 0; text-decoration:none; }
  .item .t{
    font-size:var(--title); line-height:1.5; color:var(--link); word-break:break-word; overflow-wrap:anywhere;
  }
  .item .m{ display:block; margin-top:6px; font-size:var(--meta); color:var(--muted); }
  /* 提高可点区域（至少44px） */
  .item{ min-height:44px; }
  /* 窄屏优化 */
  @media (max-width:480px){
    .wrap{ padding-bottom:16px; }
    header{ align-items:center; }
    .chip{ padding:6px 10px; }
  }
</style>

<body>
  <div class="wrap">
    <header>
      <h1>📰 简易新闻汇聚</h1>
      <div id="updated" class="chip">更新中…</div>
    </header>

    <ul id="list"></ul>

    <footer style="margin-top:18px;color:var(--muted);font-size:var(--meta);">
      <span id="foot"></span>
    </footer>
  </div>

<script>
function timeAgo(ts){
  const diff = Math.floor(Date.now()/1000 - ts);
  const units = [["天",86400],["小时",3600],["分钟",60]];
  for(const [n,s] of units){ if(diff>=s) return Math.floor(diff/s)+n+"前"; }
  return "刚刚";
}
fetch("news.json?_="+Date.now())
  .then(r=>r.json())
  .then(d=>{
    const updated = new Date(d.updated*1000);
    document.getElementById("updated").textContent =
      "更新于 " + updated.toLocaleString();
    const list = document.getElementById("list");
    d.items.forEach(it=>{
      const li = document.createElement("li");
      li.innerHTML = `
        <a class="item" href="${it.url}" target="_blank" rel="noopener">
          <span class="t">${it.title}</span>
          <span class="m">来源：${it.source} · ${timeAgo(it.published)}</span>
        </a>`;
      list.appendChild(li);
    });
    document.getElementById("foot").textContent =
      "共 " + d.items.length + " 条 · 构建时间 " + updated.toLocaleTimeString();
  })
  .catch(()=>{
    document.getElementById("updated").textContent="无法加载新闻数据";
  });
</script>
</body>
</html>
